CREATE OR REPLACE FUNCTION STATS_APEX.COMPARE_COLUMNS (V_COL1 IN VARCHAR2, V_COL2 IN VARCHAR2) 
RETURN BOOLEAN
IS
RESULT BOOLEAN;

TAB APEX_APPLICATION_GLOBAL.VC_ARR2;
TAB2 APEX_APPLICATION_GLOBAL.VC_ARR2;
COUNT1 INTEGER;
COUNT2 INTEGER;

BEGIN

TAB := APEX_UTIL.STRING_TO_TABLE (V_COL1);
TAB2 := APEX_UTIL.STRING_TO_TABLE(V_COL2);
COUNT1:=TAB.COUNT;
COUNT2:=TAB2.COUNT;

IF COUNT1 = COUNT2 THEN
RESULT:=TRUE;
ELSE
RESULT:= FALSE;
END IF;

RETURN RESULT;
END;
/
