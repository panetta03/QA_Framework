DROP TRIGGER STATS_APEX.LOG_RULE;

CREATE OR REPLACE TRIGGER STATS_APEX.LOG_RULE
AFTER UPDATE OF DELIVERED ON STATS_APEX.QA_EXEC_SCHEDULE
FOR EACH ROW
WHEN (NEW.DELIVERED IN ('Y','E'))
BEGIN


INSERT INTO QA_LOG (RULE_ID, REPORT_YEAR_MONTH,START_TIME,ELAPSED_TIME)
VALUES( :NEW.RULE_ID,(SELECT REPORT_YEAR_MONTH FROM CUSTGEN.RSD_TIME_PERIOD@REGISP.WORLD RSD WHERE RSD.TIME_PERIOD = 'MRMO'), :OLD.EXEC_TIME,CURRENT_TIMESTAMP-:OLD.EXEC_TIME);


END;
/
